"use strict";
/**
 * Unit tests for the API keys module.
 */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const axios_1 = __importDefault(require("axios"));
const web3_1 = __importDefault(require("web3"));
const src_1 = require("../src");
const util_1 = require("./helpers/util");
const apiKeyCredentials = {
    key: 'd53c3a7d-3add-68db-a9c3-9ad582313c8e',
    secret: '85BR_H-GC7HS3aydOxLw3zjRuDI6RYVgFmsYaKJh',
    passphrase: '1qYatmED3wy9RnDZsGnR',
};
describe('API Keys Module & Private Module', () => {
    it('signs a private request', async () => {
        (0, util_1.asMock)(axios_1.default).mockResolvedValue({});
        const web3 = new web3_1.default();
        const client = new src_1.DydxClient('https://example.com', { web3, apiKeyCredentials });
        await client.private.getApiKeys();
        expect(axios_1.default).toHaveBeenCalledTimes(1);
        expect(axios_1.default).toHaveBeenCalledWith({
            url: expect.stringContaining('/v3/api-keys'),
            method: 'GET',
            headers: {
                'DYDX-API-KEY': expect.stringMatching(/[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}/),
                'DYDX-TIMESTAMP': expect.any(String),
                'DYDX-PASSPHRASE': expect.stringMatching(/^[A-Za-z0-9_-]{20}$/),
                'DYDX-SIGNATURE': expect.any(String),
            },
            data: undefined,
        });
    });
    it('signs an ApiKey request', async () => {
        (0, util_1.asMock)(axios_1.default).mockResolvedValue({});
        const web3 = new web3_1.default();
        const account = web3.eth.accounts.wallet.create(1)[0];
        const client = new src_1.DydxClient('https://example.com', { web3 });
        await client.ethPrivate.deleteApiKey(apiKeyCredentials.key, account.address);
        expect(axios_1.default).toHaveBeenCalledTimes(1);
        expect(axios_1.default).toHaveBeenCalledWith({
            url: expect.stringContaining('/v3/api-keys'),
            method: 'DELETE',
            headers: {
                'DYDX-SIGNATURE': expect.stringMatching(/0x[0-9a-f]{130}/),
                'DYDX-TIMESTAMP': expect.any(String),
                'DYDX-ETHEREUM-ADDRESS': expect.stringMatching(/0x[0-9a-fA-F]{40}/),
            },
        });
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBpLWtleXMudGVzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL19fdGVzdHNfXy9hcGkta2V5cy50ZXN0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7R0FFRzs7Ozs7QUFFSCxrREFBNkM7QUFDN0MsZ0RBQXdCO0FBRXhCLGdDQUF3RTtBQUN4RSx5Q0FBd0M7QUFFeEMsTUFBTSxpQkFBaUIsR0FBc0I7SUFDM0MsR0FBRyxFQUFFLHNDQUFzQztJQUMzQyxNQUFNLEVBQUUsMENBQTBDO0lBQ2xELFVBQVUsRUFBRSxzQkFBc0I7Q0FDbkMsQ0FBQztBQUVGLFFBQVEsQ0FBQyxrQ0FBa0MsRUFBRSxHQUFHLEVBQUU7SUFDaEQsRUFBRSxDQUFDLHlCQUF5QixFQUFFLEtBQUssSUFBSSxFQUFFO1FBQ3ZDLElBQUEsYUFBTSxFQUFDLGVBQUssQ0FBQyxDQUFDLGlCQUFpQixDQUFDLEVBQW1CLENBQUMsQ0FBQztRQUVyRCxNQUFNLElBQUksR0FBRyxJQUFJLGNBQUksRUFBRSxDQUFDO1FBQ3hCLE1BQU0sTUFBTSxHQUFHLElBQUksZ0JBQVUsQ0FBQyxxQkFBcUIsRUFBRSxFQUFFLElBQUksRUFBRSxpQkFBaUIsRUFBRSxDQUFDLENBQUM7UUFDbEYsTUFBTSxNQUFNLENBQUMsT0FBTyxDQUFDLFVBQVUsRUFBRSxDQUFDO1FBRWxDLE1BQU0sQ0FBQyxlQUFLLENBQUMsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUN2QyxNQUFNLENBQUMsZUFBSyxDQUFDLENBQUMsb0JBQW9CLENBQUM7WUFDakMsR0FBRyxFQUFFLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxjQUFjLENBQUM7WUFDNUMsTUFBTSxFQUFFLEtBQUs7WUFDYixPQUFPLEVBQUU7Z0JBQ1AsY0FBYyxFQUFFLE1BQU0sQ0FBQyxjQUFjLENBQUMsNkVBQTZFLENBQUM7Z0JBQ3BILGdCQUFnQixFQUFFLE1BQU0sQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDO2dCQUNwQyxpQkFBaUIsRUFBRSxNQUFNLENBQUMsY0FBYyxDQUFDLHFCQUFxQixDQUFDO2dCQUMvRCxnQkFBZ0IsRUFBRSxNQUFNLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQzthQUNyQztZQUNELElBQUksRUFBRSxTQUFTO1NBQ2hCLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsRUFBRSxDQUFDLHlCQUF5QixFQUFFLEtBQUssSUFBSSxFQUFFO1FBQ3ZDLElBQUEsYUFBTSxFQUFDLGVBQUssQ0FBQyxDQUFDLGlCQUFpQixDQUFDLEVBQW1CLENBQUMsQ0FBQztRQUVyRCxNQUFNLElBQUksR0FBRyxJQUFJLGNBQUksRUFBRSxDQUFDO1FBQ3hCLE1BQU0sT0FBTyxHQUFvQixJQUFJLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3ZFLE1BQU0sTUFBTSxHQUFHLElBQUksZ0JBQVUsQ0FBQyxxQkFBcUIsRUFBRSxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7UUFDL0QsTUFBTSxNQUFNLENBQUMsVUFBVSxDQUFDLFlBQVksQ0FBQyxpQkFBaUIsQ0FBQyxHQUFHLEVBQUUsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBRTdFLE1BQU0sQ0FBQyxlQUFLLENBQUMsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUN2QyxNQUFNLENBQUMsZUFBSyxDQUFDLENBQUMsb0JBQW9CLENBQUM7WUFDakMsR0FBRyxFQUFFLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxjQUFjLENBQUM7WUFDNUMsTUFBTSxFQUFFLFFBQVE7WUFDaEIsT0FBTyxFQUFFO2dCQUNQLGdCQUFnQixFQUFFLE1BQU0sQ0FBQyxjQUFjLENBQUMsaUJBQWlCLENBQUM7Z0JBQzFELGdCQUFnQixFQUFFLE1BQU0sQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDO2dCQUNwQyx1QkFBdUIsRUFBRSxNQUFNLENBQUMsY0FBYyxDQUFDLG1CQUFtQixDQUFDO2FBQ3BFO1NBQ0YsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyJ9